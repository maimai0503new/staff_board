# 職員室予定表サイネージ (Staff Room Digital Signage)

Googleカレンダーの予定を取得し、職員室のディスプレイやタブレットに表示するためのGoogle Apps Script (GAS) ウェブアプリケーションです。

## 機能
* **自動日付切り替え**: 
  * 平日は当日を表示。
  * 17時を過ぎると翌日の予定を表示。
  * 金曜17時以降や土日は、次の月曜（平日）を表示。
* **祝日・休日対応**:
  * 日本の祝日カレンダーを自動参照し、休日をスキップ。
  * 「節分」「バレンタイン」など、カレンダー上の行事だが休日ではない日を平日として正しく判定するフィルタ機能付き。
* **3カラム表示**: 教職員、生徒、出張の3つのカレンダーを並列表示。
* **自動更新**: 画面を開いたままでも5分ごとに最新情報を取得。

## セットアップ手順

### 1. プロジェクトの作成
1. Googleドライブで新規作成 > その他 > Google Apps Script を選択。
2. `Code.gs` の中身をこのリポジトリの `Code.gs` に書き換え。
3. `Index.html` を作成し、このリポジトリの `Index.html` に書き換え。

### 2. 環境変数の設定 (重要)
カレンダーIDはコードに直接書かず、**スクリプトプロパティ**に設定します。

1. GASエディタの左メニュー「プロジェクトの設定 (歯車アイコン)」をクリック。
2. 下部の「スクリプト プロパティ」で「プロパティを追加」をクリック。
3. 以下の3つを設定して保存します。

| プロパティ名 (キー) | 値 (例) | 説明 |
| --- | --- | --- |
| `CAL_ID_STAFF` | `abc...123@group.calendar.google.com` | 教職員用のカレンダーID |
| `CAL_ID_STUDENT` | `xyz...789@group.calendar.google.com` | 生徒用のカレンダーID |
| `CAL_ID_TRIP` | `def...456@group.calendar.google.com` | 出張・研修用のカレンダーID |

### 3. デプロイ
1. 右上の「デプロイ」 > 「新しいデプロイ」を選択。
2. 種類の選択（歯車） > 「ウェブアプリ」。
3. 次のように設定して「デプロイ」。
   * **説明**: 初回デプロイ
   * **次のユーザーとして実行**: 自分 (Me)
   * **アクセスできるユーザー**: 組織内のユーザー (または 全員)
4. 発行されたURLにアクセスして動作確認。

## ライセンス
MIT License
